<?xml version="1.0" encoding="UTF-8"?>
<document>
	<properties>
		<title>Unit Testing for an Annotation Processing Tools</title>
	</properties>
	<body>
		<section name="Aptina Unit">
			<p>
				<strong>Aptina Unit</strong>
				は，
				<a href="http://jcp.org/en/jsr/detail?id=269">
					Pluggable Annotation Processing API (JSR 269)
				</a>
				を利用した注釈処理ツールの単体テストを支援する
				<a href="http://www.junit.org/">JUnit</a>
				拡張を提供します．
			</p>
		</section>

		<section name="AptinaTestCase">
			<p>
				<strong>
					<code>AptinaTestCase</code>
				</strong>
				は JUnit の
				<code>TestCase</code>
				を拡張したクラスで， テストメソッドの中で
				<a href="http://jcp.org/en/jsr/detail?id=199">
					Java Compiler API (JSR 199)
				</a>
				を使用して実際に Java コンパイラを起動し，
				Annotation Processor
				の単体テストを可能にします．
			</p>
			<p>
				テストクラスを IDE で起動すれば， Annotation Processor のデバッグも容易にできます．
			</p>
			<p>
				Annotation Processor のテストクラスを作成するには，
				<code>AptinaTestCase</code>
				のサブクラスを作成します．
			</p>
			<p>
				次のサンプルは，
				<code>src/test/java</code>
				フォルダにある
				<code>TestSource.java</code>
				がコンパイルすると，
				<code>foo.bar.Baz</code>
				クラスのソースを生成する
				<code>TestProcessor</code>
				のテストクラスです．
			</p>

			<source><![CDATA[
public class TestProcessorTest extends AptinaTestCase {

    @Override
    protected void setUp() throws Exception {
        super.setUp();
        // ソースパスを追加
        addSourcePath("src/test/java");
    }

    public void test() throws Exception {
        // テスト対象の Annotation Processor を生成して追加
        TestProcessor processor = new TestProcessor();
        addProcessor(processor);

        // コンパイル対象を追加
        addCompilationUnit(TestSource.class);

        // コンパイル実行
        compile();

        // テスト対象の Annotation Processor が生成したソースを検証
        assertEqualsGeneratedSource("package foo.bar; public class Baz {}",
                "foo.bar.Baz");
    }

}
]]></source>
			<p>
				詳細は
				<a href="apidocs/index.html">Javadoc</a>
				を参照してください．
			</p>
		</section>
	</body>
</document>
